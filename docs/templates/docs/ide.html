{% extends 'base.html' %} {% block content %}

<h1>Hello World!</h1>

<form id="form">
  <textarea name="message" cols="50" rows="50" id="text-area"></textarea>
</form>

<script type="text/javascript">
  let url = "ws://" + window.location.host.toString() + "/ws/socket-server/";

  const chatSocket = new WebSocket(url);

  chatSocket.onmessage = function (e) {
    let data = JSON.parse(e.data);
    console.log("Data: ", data);

    if (data.type === "chat") {
      let messages = document.getElementById("messages");

      document.getElementById("text-area").textContent = data.message;
    }
  };

  let input = document.querySelector('textarea[name="message"]');
  input.addEventListener("input", (e) => {
    let message = e.target.value;
    chatSocket.send(
      JSON.stringify({
        message: message,
      })
    );
  });
</script>
{% endblock %}
